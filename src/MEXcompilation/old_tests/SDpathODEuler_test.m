% obtained by running:
% PathFinder(-0.5,1,[],[1 0 -0.5 -1 0],1000,5,'use mex',false,'plot');
% and putting a breakpoint after SDpathODEuler_v4, in countourSD

% cd '/home/andrew/OneDrive/PathFinder/src/myMEX';

%% --------------   inputs to the MEX function  ---------------- %
h0 = -0.5;
gCoeffs =  [1.0000;
            0;
            -0.5000;
            -1.0000;
            0];
SPs = [  1.000000000000000 + 0.000000000000000i
         -0.380344926701142 - 0.428936813297590i
         -0.380344926701142 + 0.428936813297590i
          0.760689853402284 + 0.000000000000000i];
cover_radii = [0
               0.053251960713096
               0.053251960713096
               0.044943127416225];
valleys = [ -0.382683432365090 + 0.923879532511287i
             -0.923879532511287 - 0.382683432365090i
              0.382683432365090 - 0.923879532511287i
              0.923879532511287 + 0.382683432365090i];
base_step_size = 0.1000;
n_max = 50000;
r_star = 0.871375429598998;
Newton_small_threshold = 1e-13;
Newton_big_threshold = 0.01;

%% --------------   outputs of the MEX function  ---------------- %
p_ = [0
   0.044531351469279
   0.084695507452337
   0.120916001913867
   0.153796198585452
   0.184067828285870
   0.212550904705085
   0.240129069964424
   0.267740906501201
   0.296387595889845
   0.327157231130464
   0.361265544419811
   0.400112822734170
   0.445358029455789
   0.499013373610477
   0.563565261393611
   0.642130556715586
   0.738660566323979];

h_ = [ -0.500000000000000 + 0.000000000000000i
      -0.502002844321048 - 0.044530282501378i
      -0.507381863554622 - 0.084650450741528i
      -0.515467408840023 - 0.120630167325067i
      -0.525810693601098 - 0.152790848545489i
      -0.538106300410570 - 0.181481005536577i
      -0.552146340734159 - 0.207067191841158i
      -0.567798267177954 - 0.229929084805306i
      -0.584996203736666 - 0.250451648593456i
      -0.603736575320772 - 0.269013109193111i
      -0.624071891637772 - 0.285972676036019i
      -0.646101449297594 - 0.301662752430954i
      -0.669960975614569 - 0.316387404199403i
      -0.695813561156554 - 0.330425770338205i
      -0.723843055474861 - 0.344037946858751i
      -0.754249991883862 - 0.357471260377648i
      -0.787249578570569 - 0.370965719454805i
      -0.823071212504137 - 0.384758168879465i];
valley_index_ = 2;
other_ball_index_ = [];

%% ------------------- create the MEX function ------------------- %
mex -output SDpathODEuler_myMex -g SDpathODEuler.c;
disp('created mex file');

%% -------------------- test the MEX function -------------------- %
[p, h, valley_index, other_ball_index] = ...
            SDpathODEuler_myMex(h0, gCoeffs, SPs, cover_radii, valleys,...
            base_step_size, int64(n_max), r_star,...
            Newton_small_threshold, Newton_big_threshold);