% obtained by running:
% PathFinder(-0.5,1,[],[1 0 -0.5 -1 0],1000,5,'use mex',false,'plot');
% and putting a breakpoint after SDpathODEuler_v4, in countourSD

% cd '/home/andrew/OneDrive/PathFinder/src/myMEX';
addpath ../..;
addPaths;
%% --------------   inputs to the MEX function  ---------------- %
h0 = -0.371548798763269 + 0.376416346305286i;
gCoeffs =  [1.0000;
            0;
            -0.5000;
            -1.0000;
            0];
SPs = [  -0.500000000000000 + 0.000000000000000i
          1.000000000000000 + 0.000000000000000i
         -0.380344926701142 - 0.428936813297590i
          0.760689853402284 + 0.000000000000000i];
cover_radii = [0
              0
               0.053251960713096
               0.044943127416225];
valleys = [ -0.382683432365090 + 0.923879532511287i
             -0.923879532511287 - 0.382683432365090i
              0.382683432365090 - 0.923879532511287i
              0.923879532511287 + 0.382683432365090i];
base_step_size = 0.1000;
n_max = 50000;
r_star = 0.871375429598998;
Newton_small_threshold = 1e-13;
Newton_big_threshold = 0.01;

%% --------------   outputs of the MEX function  ---------------- %
p_ = [0
   0.002384041905456
   0.005828876839155
   0.010845270658052
   0.018227999055088
   0.029254669753067
   0.046082820298237
   0.072653318528022
   0.113360301923547
   0.155577897520242
   0.196757116926100
   0.235330671341699
   0.270453604776950
   0.301773640855163
   0.329257955685207
   0.353070579924509
   0.373488186054408
   0.390843381621786
   0.405487336581967
   0.417765912952421
   0.428005178842501
   0.436503387536691
   0.443527339250177
   0.449311636610453
   0.454059773167340
   0.457946307139794
   0.461119602325755
   0.463704786295022
   0.465806698033226
   0.467512684512854
   0.468895166930861
   0.470013939280079];

h_ = [ -0.371548798763269 + 0.376416346305286i
 -0.369810959618115 + 0.365872423411754i
 -0.367754129821844 + 0.352952763524563i
 -0.365311797898585 + 0.336977869465088i
 -0.362406673008724 + 0.316991282348981i
 -0.358950079162836 + 0.291571810922987i
 -0.354848959864674 + 0.258455853127213i % this is where they deviate
 -0.350037567830361 + 0.213641311849212i
 -0.344997570134639 + 0.154037201097552i
 -0.341731274084450 + 0.098097511516341i
 -0.339988269010806 + 0.046378747338329i
 -0.339485173655488 - 0.000989017006823i
 -0.339940740640361 - 0.044111739469551i
 -0.341104434110921 - 0.083210839698317i
 -0.342766024488683 - 0.118560561534940i
 -0.344755948021035 - 0.150453961288885i
 -0.346941481213983 - 0.179184095294387i
 -0.349221366634252 - 0.205033684105436i
 -0.351520239554934 - 0.228269656239747i
 -0.353783495040424 - 0.249140555326167i
 -0.355972848036582 - 0.267875641978823i
 -0.358062636743804 - 0.284684995784762i
 -0.360036821860292 - 0.299760196718164i
 -0.361886594106576 - 0.313275327708153i
 -0.363608492458394 - 0.325388138456550i
 -0.365202940242621 - 0.336241271264529i
 -0.366673117199344 - 0.345963487612789i
 -0.368024098327862 - 0.354670858327285i
 -0.369262202633443 - 0.362467895585016i
 -0.370394505833257 - 0.369448614949129i
 -0.371428480371858 - 0.375697522032252i
 -0.372371914970817 - 0.381291215846445i];
valley_index_ = [];
other_ball_index_ = 3;

%% ------------------- create the MEX function ------------------- %
mex -output SDpathODEuler_myMex -g SDpathODEuler.c;
disp('created mex file');

%% -------------------- test the MEX function -------------------- %
[p, h, valley_index, other_ball_index] = ...
            SDpathODEuler_myMex(h0, gCoeffs, SPs, cover_radii, valleys,...
            base_step_size, int64(n_max), r_star,...
            Newton_small_threshold, Newton_big_threshold);